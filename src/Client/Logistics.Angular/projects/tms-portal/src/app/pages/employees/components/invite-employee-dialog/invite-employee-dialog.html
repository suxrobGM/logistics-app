<p-dialog
  header="Invite Employee"
  [(visible)]="visible"
  [modal]="true"
  [style]="{ width: '450px' }"
  (onHide)="close()"
>
  @if (isLoading()) {
    <div class="flex justify-center py-4">
      <p-progress-spinner />
    </div>
  } @else {
    <p class="text-muted-color mb-4">
      Send an email invitation to join your company as an employee.
    </p>

    <form [formGroup]="form" (ngSubmit)="submit()">
      <app-labeled-field label="Email Address" for="email" [required]="true" [control]="form.controls.email">
        <input
          pInputText
          id="email"
          formControlName="email"
          type="email"
          placeholder="employee@example.com"
          class="w-full"
        />
      </app-labeled-field>

      <app-labeled-field label="Role" for="role" [required]="true" [control]="form.controls.role">
        <p-select
          formControlName="role"
          id="role"
          class="w-full"
          appendTo="body"
          [options]="roles()"
          optionValue="name"
          optionLabel="displayName"
          placeholder="Select a role"
        />
      </app-labeled-field>

      <app-labeled-field label="Personal Message" for="personalMessage" hint="Optional note to include in the invitation email">
        <textarea
          pTextarea
          id="personalMessage"
          formControlName="personalMessage"
          rows="3"
          placeholder="Add a personal note to the invitation email..."
          class="w-full"
        ></textarea>
      </app-labeled-field>

      <div class="flex gap-2 justify-end">
        <p-button
          type="button"
          label="Cancel"
          severity="secondary"
          [outlined]="true"
          (click)="close()"
        />
        <p-button
          type="submit"
          icon="pi pi-send"
          label="Send Invitation"
          [disabled]="isLoading() || form.invalid"
        />
      </div>
    </form>
  }
</p-dialog>
