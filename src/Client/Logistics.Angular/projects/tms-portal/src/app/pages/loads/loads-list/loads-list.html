<div class="animate-fadein">
  <!-- Header -->
  <div class="flex items-center">
    <h1 class="text-primary mb-0">List Loads</h1>
    <p-button
      styleClass="ml-2"
      icon="pi pi-plus-circle"
      size="large"
      [rounded]="true"
      [text]="true"
      pTooltip="Add a new load"
      aria-label="Add a new load"
      [routerLink]="['/loads/add']"
    />
    <p-button
      styleClass="ml-2"
      icon="pi pi-file-import"
      size="large"
      [rounded]="true"
      [text]="true"
      pTooltip="Import from PDF"
      aria-label="Import from PDF"
      [routerLink]="['/loads/import']"
    />
    <p-button
      styleClass="ml-2"
      icon="pi pi-download"
      size="large"
      [rounded]="true"
      [text]="true"
      pTooltip="Export to CSV"
      aria-label="Export to CSV"
      (click)="exportToCsv()"
      [disabled]="store.isEmpty()"
    />
  </div>

  <!-- Summary Stats -->
  <app-loads-summary-stats
    [loads]="store.data()"
    [totalRecords]="store.totalRecords()"
    [isLoading]="store.isLoading()"
  />

  <!-- Filter Panel -->
  <app-loads-filter-panel
    [isLoading]="store.isLoading()"
    (filtersChanged)="onFiltersChanged($event)"
    (searchChanged)="onSearchChanged($event)"
  />

  <!-- Bulk Action Toolbar -->
  @if (selectedLoads().length > 0) {
    <app-loads-bulk-toolbar
      [selectedLoads]="selectedLoads()"
      [isProcessing]="isBulkProcessing()"
      (assignRequested)="openBulkAssignDialog()"
      (dispatched)="onBulkDispatched()"
      (deleted)="onBulkDeleted()"
      (selectionCleared)="clearSelection()"
    />
  }

  <!-- Data Table -->
  <app-loads-table
    [data]="store.data()"
    [isLoading]="store.isLoading()"
    [error]="store.error()"
    [isEmpty]="store.isEmpty()"
    [totalRecords]="store.totalRecords()"
    [pageSize]="store.pageSize()"
    [first]="store.first()"
    [(selectedLoads)]="selectedLoads"
    (lazyLoad)="store.onLazyLoad($event)"
    (retry)="store.retry()"
    (addLoad)="addLoad()"
    (assignLoad)="onAssignLoad($event)"
    (dispatchLoad)="onDispatchLoad($event)"
  />

  <!-- Bulk Assign Dialog -->
  <app-bulk-assign-dialog
    [loads]="selectedLoads()"
    [(visible)]="showBulkAssignDialog"
    (assigned)="onBulkAssigned()"
  />
</div>
