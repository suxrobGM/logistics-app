<p-dialog
  header="Add Payment Method"
  [(visible)]="showDialog"
  [modal]="true"
  [style]="{ width: '50vw' }"
>
  <form class="grid grid-cols-12 gap-x-5" [formGroup]="form" (ngSubmit)="submit()">
    <shared-validation-summary [form]="form" />

    <div class="col-span-12">
      <h5>Choose payment method:</h5>

      <shared-labeled-field label="Payment Type" for="methodType">
        <p-select
          formControlName="methodType"
          [options]="paymentMethodTypes()"
          class="w-full"
        ></p-select>
      </shared-labeled-field>

      @if (form.get("methodType")?.value === "card") {
        <h5>Credit/Debit card details</h5>
        <p-divider />

        <shared-labeled-field label="Cardholder Name" for="cardHolderName">
          <input
            id="cardHolderName"
            formControlName="cardHolderName"
            pInputText
            placeholder="ex. John Smith"
          />
        </shared-labeled-field>

        <div class="mb-4">
          <app-stripe-card (ready)="setCardNumberElement($event.cardNumber)" />
        </div>
      } @else if (form.get("methodType")?.value === "us_bank_account") {
        <h5>US bank account details</h5>
        <p-divider />

        <shared-labeled-field label="Bank Name" for="bankName">
          <input formControlName="bankName" pInputText placeholder="ex. Bank of America" />
        </shared-labeled-field>

        <shared-labeled-field label="Account Type" for="bankAccountType">
          <p-select
            formControlName="bankAccountType"
            [options]="usBankAccountTypes"
            class="w-full"
          ></p-select>
        </shared-labeled-field>

        <shared-labeled-field label="Account Number" for="bankAccountNumber">
          <input
            formControlName="bankAccountNumber"
            pInputText
            pKeyFilter="int"
            placeholder="ex. 1234567891011"
          />
        </shared-labeled-field>

        <shared-labeled-field label="Routing Number" for="bankRoutingNumber">
          <input
            formControlName="bankRoutingNumber"
            pInputText
            pKeyFilter="int"
            placeholder="ex. 123456789"
          />
        </shared-labeled-field>

        <shared-labeled-field label="Account Holder Type" for="bankAccountHolderType">
          <p-select
            formControlName="bankAccountHolderType"
            [options]="usBankAccountHolderTypes"
            class="w-full"
          />
        </shared-labeled-field>

        <shared-labeled-field label="Account Holder Name" for="bankAccountHolderName">
          <input formControlName="bankAccountHolderName" pInputText placeholder="ex. John Smith" />
        </shared-labeled-field>
      } @else if (form.get("methodType")?.value === "international_bank_account") {
        <h5>International bank account details</h5>
        <p-divider />

        <shared-labeled-field label="Bank Name" for="bankName">
          <input formControlName="bankName" pInputText placeholder="ex. Bank of America" />
        </shared-labeled-field>

        <shared-labeled-field label="Account Number" for="bankAccountNumber">
          <input formControlName="bankAccountNumber" pInputText placeholder="ex. 1234567891011" />
        </shared-labeled-field>

        <shared-labeled-field label="SWIFT Code" for="swiftCode">
          <input formControlName="swiftCode" pInputText placeholder="ex. ABCD1234" />
        </shared-labeled-field>

        <shared-labeled-field label="Account Holder Name" for="bankAccountHolderName">
          <input formControlName="bankAccountHolderName" pInputText placeholder="ex. John Smith" />
        </shared-labeled-field>
      }
    </div>

    <div class="col-span-12">
      <h5>Billing address</h5>
      <p-divider />
      <shared-address-form formControlName="billingAddress" />
    </div>

    <div class="flex gap-2">
      <p-button type="submit" label="Save" icon="pi pi-check" [loading]="isLoading()" />
      <p-button label="Cancel" icon="pi pi-times" (click)="showDialog.set(false)" />
    </div>
  </form>
</p-dialog>
