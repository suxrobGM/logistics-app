<div class="animate-fadein">
  <h1 class="text-center">Invoice Dashboard</h1>

  <div class="animate-stagger grid grid-cols-12 gap-4">
    <!-- Stats Cards -->
    @if (isLoading()) {
      @for (_ of [1, 2, 3, 4, 5]; track $index) {
        <div class="col-span-12 md:col-span-6 lg:col-span-4 xl:col-span-2">
          <p-card>
            <p-skeleton height="4rem" />
          </p-card>
        </div>
      }
    } @else {
      <!-- Draft -->
      <div class="col-span-12 md:col-span-6 lg:col-span-4 xl:col-span-2">
        <p-card class="h-full">
          <div class="flex flex-col items-center gap-2">
            <span class="text-sm text-gray-500">Draft</span>
            <span class="text-2xl font-bold">{{ dashboard()?.draftCount ?? 0 }}</span>
            <span class="text-lg text-gray-600">{{ dashboard()?.draftAmount | currency }}</span>
          </div>
        </p-card>
      </div>

      <!-- Pending -->
      <div class="col-span-12 md:col-span-6 lg:col-span-4 xl:col-span-2">
        <p-card class="h-full">
          <div class="flex flex-col items-center gap-2">
            <span class="text-sm text-gray-500">Pending</span>
            <span class="text-2xl font-bold text-yellow-600">{{
              dashboard()?.pendingCount ?? 0
            }}</span>
            <span class="text-lg text-gray-600">{{ dashboard()?.pendingAmount | currency }}</span>
          </div>
        </p-card>
      </div>

      <!-- Overdue -->
      <div class="col-span-12 md:col-span-6 lg:col-span-4 xl:col-span-2">
        <p-card class="h-full border-red-200">
          <div class="flex flex-col items-center gap-2">
            <span class="text-sm text-gray-500">Overdue</span>
            <span class="text-2xl font-bold text-red-600">{{
              dashboard()?.overdueCount ?? 0
            }}</span>
            <span class="text-lg text-red-600">{{ dashboard()?.overdueAmount | currency }}</span>
          </div>
        </p-card>
      </div>

      <!-- Partially Paid -->
      <div class="col-span-12 md:col-span-6 lg:col-span-4 xl:col-span-2">
        <p-card class="h-full">
          <div class="flex flex-col items-center gap-2">
            <span class="text-sm text-gray-500">Partially Paid</span>
            <span class="text-2xl font-bold text-orange-600">{{
              dashboard()?.partiallyPaidCount ?? 0
            }}</span>
            <span class="text-lg text-gray-600">{{
              dashboard()?.partiallyPaidAmount | currency
            }}</span>
          </div>
        </p-card>
      </div>

      <!-- Paid -->
      <div class="col-span-12 md:col-span-6 lg:col-span-4 xl:col-span-2">
        <p-card class="h-full">
          <div class="flex flex-col items-center gap-2">
            <span class="text-sm text-gray-500">Paid</span>
            <span class="text-2xl font-bold text-green-600">{{ dashboard()?.paidCount ?? 0 }}</span>
            <span class="text-lg text-gray-600">{{ dashboard()?.paidAmount | currency }}</span>
          </div>
        </p-card>
      </div>

      <!-- Total Outstanding -->
      <div class="col-span-12 md:col-span-6 lg:col-span-4 xl:col-span-2">
        <p-card class="h-full bg-blue-50 dark:bg-gray-800">
          <div class="flex flex-col items-center gap-2">
            <span class="text-sm text-gray-500">Outstanding</span>
            <span class="text-2xl font-bold text-blue-600">{{
              dashboard()?.totalOutstanding | currency
            }}</span>
            <span class="text-sm text-gray-500"
              >This Month: {{ dashboard()?.collectedThisMonth | currency }}</span
            >
          </div>
        </p-card>
      </div>
    }

    <!-- Quick Actions -->
    <div class="col-span-12">
      <p-card header="Quick Actions">
        <div class="flex flex-wrap gap-2">
          <a routerLink="/invoices/loads" class="no-underline">
            <p-button label="View All Invoices" icon="pi pi-list" [outlined]="true" />
          </a>
          <a routerLink="/invoices/payroll" class="no-underline">
            <p-button label="Payroll Invoices" icon="pi pi-users" [outlined]="true" />
          </a>
          <a routerLink="/settings/payments" class="no-underline">
            <p-button label="Setup Payments" icon="pi pi-credit-card" [outlined]="true" />
          </a>
        </div>
      </p-card>
    </div>

    <!-- Recent Invoices -->
    <div class="col-span-12">
      <p-card header="Recent Invoices">
        @if (isLoading()) {
          <p-skeleton height="12rem" />
        } @else {
          <p-table
            [value]="dashboard()?.recentInvoices ?? []"
            [rows]="10"
            [tableStyle]="{ 'min-width': '50rem' }"
          >
            <ng-template #header>
              <tr>
                <th>Invoice #</th>
                <th>Customer</th>
                <th>Amount</th>
                <th>Status</th>
                <th>Created Date</th>
                <th>Due Date</th>
                <th style="width: 6rem">Actions</th>
              </tr>
            </ng-template>
            <ng-template #body let-invoice>
              <tr>
                <td>
                  <a [routerLink]="getInvoiceLink(invoice)">
                    {{ invoice.number }}
                  </a>
                </td>
                <td>{{ invoice.customer?.name ?? "-" }}</td>
                <td>{{ invoice.total?.amount | currency }}</td>
                <td><app-invoice-status-tag [status]="invoice.status" /></td>
                <td>{{ invoice.createdDate | date: "shortDate" }}</td>
                <td>{{ invoice.dueDate | date: "shortDate" }}</td>
                <td>
                  <a [routerLink]="getInvoiceLink(invoice)">
                    <p-button
                      icon="pi pi-eye"
                      [rounded]="true"
                      [text]="true"
                      pTooltip="View Details"
                      tooltipPosition="top"
                    />
                  </a>
                </td>
              </tr>
            </ng-template>
            <ng-template #emptymessage>
              <tr>
                <td colspan="7" class="p-4 text-center text-gray-500">No recent invoices</td>
              </tr>
            </ng-template>
          </p-table>
        }
      </p-card>
    </div>
  </div>
</div>
