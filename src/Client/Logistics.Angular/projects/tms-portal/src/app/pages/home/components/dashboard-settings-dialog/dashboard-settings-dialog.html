<p-dialog
  [(visible)]="visible"
  header="Customize Dashboard"
  [modal]="true"
  [style]="{ width: '480px' }"
  [draggable]="false"
  [resizable]="false"
>
  <div class="bg-surface border-subtle mb-4 rounded-lg border px-4 py-3">
    <p class="text-muted m-0 text-sm">
      Drag to reorder panels. Use checkboxes to show or hide panels.
    </p>
  </div>

  <p-orderList
    [value]="panels()"
    [dragdrop]="true"
    (onReorder)="onReorder($event)"
    [stripedRows]="true"
  >
    <ng-template let-panel #item>
      <div class="flex items-center justify-between gap-4 py-2">
        <div class="flex min-w-0 flex-1 items-center gap-3">
          <i
            class="pi pi-bars drag-handle text-muted cursor-grab text-sm active:cursor-grabbing"
          ></i>
          <p-checkbox
            [ngModel]="panel.visible"
            (ngModelChange)="toggleVisibility(panel.id)"
            [binary]="true"
            [inputId]="'panel-' + panel.id"
          />
          <label
            [for]="'panel-' + panel.id"
            class="text-primary cursor-pointer overflow-hidden text-sm font-medium text-ellipsis whitespace-nowrap"
          >
            {{ panel.label }}
          </label>
        </div>
        <div class="shrink-0">
          <p-selectButton
            [options]="sizeOptions"
            [ngModel]="panel.size"
            (ngModelChange)="updateSize(panel.id, $event)"
            optionLabel="label"
            optionValue="value"
            [allowEmpty]="false"
            size="small"
            [disabled]="!panel.visible"
          />
        </div>
      </div>
    </ng-template>
  </p-orderList>

  <ng-template #footer>
    <div class="flex w-full items-center justify-between">
      <p-button
        label="Reset to Defaults"
        [text]="true"
        severity="secondary"
        icon="pi pi-refresh"
        (click)="resetDefaults()"
      />
      <p-button label="Done" icon="pi pi-check" (click)="close()" />
    </div>
  </ng-template>
</p-dialog>
