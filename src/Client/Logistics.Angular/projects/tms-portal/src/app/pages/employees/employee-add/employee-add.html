<h1 class="text-center">Add a new employee</h1>

<div class="flex justify-center">
  <div class="w-full md:w-1/2">
    <p-card>
      @if (isLoading()) {
        <p-progress-spinner />
      }

      <form [formGroup]="form" (ngSubmit)="submit()">
        <shared-validation-summary [form]="form" />

        <shared-labeled-field label="User Name" for="name">
          <p-auto-complete
            formControlName="user"
            class="w-full"
            inputStyleClass="w-full"
            placeholder="Type user name"
            optionLabel="userName"
            [minLength]="3"
            [suggestions]="suggestedUsers()"
            (completeMethod)="searchUser($event)"
          />
        </shared-labeled-field>

        <shared-labeled-field label="Salary Type" for="salaryType">
          <p-select formControlName="salaryType" class="w-full" [options]="salaryTypes" />
        </shared-labeled-field>

        <shared-labeled-field label="Salary" for="salary">
          @if (isShareOfGrossSalary()) {
            <shared-unit-input [control]="form.controls.salary" unit="%" [min]="0" [max]="100" />
          } @else {
            <shared-currency-input [control]="form.controls.salary" [min]="0" />
          }
        </shared-labeled-field>

        <shared-labeled-field label="Role" for="role">
          <p-select
            formControlName="role"
            class="w-full"
            [options]="roles()"
            optionValue="name"
            optionLabel="displayName"
            [showClear]="true"
            (onClear)="clearSelectedRole()"
          />
        </shared-labeled-field>

        <div class="flex gap-2">
          <p-button type="submit" icon="pi pi-pencil" label="Add" [disabled]="isLoading()" />
          <p-button
            type="button"
            icon="pi pi-arrow-left"
            label="Back to list"
            [routerLink]="['/employees']"
          />
        </div>
      </form>
    </p-card>
  </div>
</div>
