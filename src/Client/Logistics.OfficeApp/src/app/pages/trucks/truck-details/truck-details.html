<h1 class="text-center">Truck Details</h1>

<div class="mt-4 grid grid-cols-12 gap-3">
  <p-card class="col-span-12 sm:col-span-6">
    @if (isLoading()) {
      <div class="mb-4 grid grid-cols-12">
        <div class="col-span-12 mb-2 md:col-span-6 md:mb-0">
          <p-skeleton class="my-2" height="3rem" />
        </div>
        <div class="col-span-12 mb-2 md:col-span-6 md:mb-0">
          <p-skeleton class="my-2" height="3rem" />
        </div>
      </div>

      <div class="mb-4 grid grid-cols-12">
        <div class="col-span-12 mb-2 md:col-span-6 md:mb-0">
          <p-skeleton class="my-2" height="3rem" />
        </div>
        <div class="col-span-12 mb-2 md:col-span-6 md:mb-0">
          <p-skeleton class="my-2" height="3rem" />
        </div>
      </div>

      <div class="mb-4 grid grid-cols-12">
        <div class="col-span-12 mb-2 md:col-span-6 md:mb-0">
          <p-skeleton class="my-2" height="3rem" />
        </div>
        <div class="col-span-12 mb-2 md:col-span-6 md:mb-0">
          <p-skeleton class="my-2" height="3rem" />
        </div>
      </div>

      <div class="mb-4 grid grid-cols-12">
        <div class="col-span-12 mb-2 md:col-span-6 md:mb-0">
          <p-skeleton class="my-2" height="3rem" />
        </div>
        <div class="col-span-12 mb-2 md:col-span-6 md:mb-0">
          <p-skeleton class="my-2" height="3rem" />
        </div>
      </div>
    } @else {
      <div class="mb-4 grid grid-cols-12">
        <div class="col-span-12 mb-2 md:col-span-6 md:mb-0">
          <span class="font-bold">Drivers: </span><br />
          <span class="mr-1">{{ truck()?.mainDriver?.fullName }}</span>

          @if (truck()?.secondaryDriver) {
            <span class="mr-1">and {{ truck()?.secondaryDriver?.fullName }}</span>
          }
        </div>
        <div class="col-span-12 mb-2 md:col-span-6 md:mb-0">
          <span class="font-bold">Truck Number: </span><br />
          <a [routerLink]="['/trucks', truck()?.id, 'edit']">{{ truck()?.number }}</a>
        </div>
      </div>

      <div class="mb-4 grid grid-cols-12">
        <div class="col-span-12 mb-2 md:col-span-6 md:mb-0">
          <span class="font-bold">Total Gross this year: </span><br />
          <span>{{ monthlyGrosses()?.totalGross | currency }}</span>
        </div>
        <div class="col-span-12 mb-2 md:col-span-6 md:mb-0">
          <span class="font-bold">Total Gross last 30 days: </span><br />
          <span>{{ dailyGrosses()?.totalGross | currency }}</span>
        </div>
      </div>

      <div class="mb-4 grid grid-cols-12">
        <div class="col-span-12 mb-2 md:col-span-6 md:mb-0">
          <span class="font-bold">Total distance this year: </span><br />
          <span>{{ monthlyGrosses()?.totalDistance | distanceUnit: "mi" }} mi</span>
        </div>
        <div class="col-span-12 mb-2 md:col-span-6 md:mb-0">
          <span class="font-bold">Total distance last 30 days: </span><br />
          <span>{{ dailyGrosses()?.totalDistance | distanceUnit: "mi" }} mi</span>
        </div>
      </div>

      <div class="mb-4 grid grid-cols-12">
        <div class="col-span-12 mb-2 md:col-span-6 md:mb-0">
          <span class="font-bold">RPM this year: </span><br />
          <span>{{ rpmAllTime() | currency }}</span>
        </div>
        <div class="col-span-12 mb-2 md:col-span-6 md:mb-0">
          <span class="font-bold">RPM last 30 days: </span><br />
          <span>{{ rpmCurrent() | currency }}</span>
        </div>
      </div>
    }
  </p-card>

  <div class="map-container col-span-12 sm:col-span-6">
    <app-geolocation-map [geolocationData]="truckLocations()" />
  </div>
</div>

<div class="mt-3">
  <app-truck-grosses-linechart [truckId]="id()!" (chartDrawn)="onLineChartDrawn($event)" />
</div>

<div class="mt-3">
  <app-grosses-barchart class="mt-3" [truckId]="id()!" (chartDrawn)="onBarChartDrawn($event)" />
</div>
