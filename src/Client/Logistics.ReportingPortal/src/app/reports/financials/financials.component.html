<h2>Financials Report</h2>

<form class="filters" (submit)="$event.preventDefault(); load();">
  <label>
    From
    <input type="date" [(ngModel)]="from" name="from">
  </label>
  <label>
    To
    <input type="date" [(ngModel)]="to" name="to">
  </label>
  <label>
    Search
    <input type="text" [(ngModel)]="search" name="search" placeholder="Customer">
  </label>
  <button type="submit">Filter</button>
  <button type="button" (click)="reset()">Reset</button>
  <button type="button" (click)="export('csv')">Export CSV</button>
  <button type="button" (click)="export('xlsx')">Export Excel</button>
  <button type="button" (click)="export('pdf')">Export PDF</button>
  <button type="button" (click)="export('docx')">Export Word</button>
</form>

<table>
  <thead>
    <tr>
      <th>Invoice #</th>
      <th>Customer</th>
      <th>Status</th>
      <th>Total</th>
      <th>Paid</th>
      <th>Due</th>
      <th>Due Date</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let i of items()">
      <td>{{ i.invoiceNumber }}</td>
      <td>{{ i.customerName }}</td>
      <td>{{ i.status }}</td>
      <td>{{ i.total }}</td>
      <td>{{ i.paid }}</td>
      <td>{{ i.due }}</td>
      <td>{{ i.dueDate | date:'yyyy-MM-dd' }}</td>
    </tr>
  </tbody>
</table>

<div class="totals">
  <div>Total Count: {{ totalCount() }}</div>
  <div>Total Invoiced: {{ totalInvoiced() }}</div>
  <div>Total Paid: {{ totalPaid() }}</div>
  <div>Total Due: {{ totalDue() }}</div>
</div>

